# The Makefile is generated automatically

# If your Gambit-C is installed to a different directory,
# you may need to change the following line accordingly
prefix=/usr/local/Gambit-C/current
includedir=$(prefix)/include
libdir=$(prefix)/lib

INCLUDES=-I$(includedir) -L$(libdir)

all: ssax-sxml.o1 # example.o1 test-sxml.out

ssax-sxml.o1: ssax-sxml.o1.c libs/gambit/common.scm libs/gambit/myenv.scm libs/srfi-13-local.scm libs/util.scm libs/gambit/parse-error.scm libs/input-parse.scm libs/look-for-str.scm ssax/char-encoding.scm ssax/SSAX-code.scm ssax/SXML-tree-trans.scm sxml-tools/sxpathlib.scm multi-parser/id/srfi-12.scm multi-parser/id/mime.scm multi-parser/id/http.scm multi-parser/id/access-remote.scm multi-parser/id/id.scm sxml-tools/xlink-parser.scm multi-parser/ssax-prim.scm multi-parser/multi-parser.scm html-prag/htmlprag.scm sxml-tools/sxml-tools.scm sxml-tools/sxpath-ext.scm sxml-tools/xpath-parser.scm sxml-tools/txpath.scm sxml-tools/sxpath.scm sxml-tools/xpath-ast.scm sxml-tools/xpath-context.scm sxml-tools/xlink.scm sxml-tools/ddo-axes.scm sxml-tools/ddo-txpath.scm sxml-tools/lazy-xpath.scm ssax/lazy-ssax.scm sxml-tools/modif.scm sxml-tools/serializer.scm sxml-tools/guides.scm stx/libmisc.scm stx/stx-engine.scm
	gcc $(INCLUDES) -shared -D___DYNAMIC libs/gambit/common.c libs/gambit/myenv.c libs/srfi-13-local.c libs/util.c libs/gambit/parse-error.c libs/input-parse.c libs/look-for-str.c ssax/char-encoding.c ssax/SSAX-code.c ssax/SXML-tree-trans.c sxml-tools/sxpathlib.c multi-parser/id/srfi-12.c multi-parser/id/mime.c multi-parser/id/http.c multi-parser/id/access-remote.c multi-parser/id/id.c sxml-tools/xlink-parser.c multi-parser/ssax-prim.c multi-parser/multi-parser.c html-prag/htmlprag.c sxml-tools/sxml-tools.c sxml-tools/sxpath-ext.c sxml-tools/xpath-parser.c sxml-tools/txpath.c sxml-tools/sxpath.c sxml-tools/xpath-ast.c sxml-tools/xpath-context.c sxml-tools/xlink.c sxml-tools/ddo-axes.c sxml-tools/ddo-txpath.c sxml-tools/lazy-xpath.c ssax/lazy-ssax.c sxml-tools/modif.c sxml-tools/serializer.c sxml-tools/guides.c stx/libmisc.c stx/stx-engine.c ssax-sxml.o1.c -o ssax-sxml.o1

ssax-sxml.o1.c libs/gambit/common.c libs/gambit/myenv.c libs/srfi-13-local.c libs/util.c libs/gambit/parse-error.c libs/input-parse.c libs/look-for-str.c ssax/char-encoding.c ssax/SSAX-code.c ssa/xSXML-tree-trans.c sxml-tools/sxpathlib.c multi-parser/id/srfi-12.c  multi-parser/id/mime.c multi-parser/id/http.c multi-parser/id/access-remote.c multi-parser/id/id.c sxml-tools/xlink-parser.c multi-parser/ssax-prim.c multi-parser/multi-parser.c html-prag/htmlprag.c sxml-tools/sxml-tools.c sxml-tools/sxpath-ext.c sxml-tools/xpath-parser.c sxml-tools/xpath.c sxml-tools/sxpath.c sxml-tools/xpath-ast.c sxml-tools/xpath-context.c sxml-tools/xlink.c sxml-tools/ddo-axes.c sxml-tools/ddo-txpath.c sxml-tools/lazy-xpath.c ssax/lazy-ssax.c sxml-tools/modif.c sxml-tools/serializer.c sxml-tools/guides.c stx/libmisc.c stx/stx-engine.c: sxml-tools/lazy-xpath.sch html-prag/htmlprag.sch stx/stx-engine.sch ssax/SSAX-code.sch sxml-tools/sxml-tools.sch libs/gambit/common.sch libs/gambit/myenv.sch multi-parser/id/srfi-12.sch multi-parser/id/http.sch libs/input-parse.sch libs/gambit/common.scm libs/gambit/myenv.scm libs/srfi-13-local.scm libs/util.scm libs/gambit/parse-error.scm libs/input-parse.scm libs/look-for-str.scm ssax/char-encoding.scm ssax/SSAX-code.scm ssax/SXML-tree-trans.scm sxml-tools/sxpathlib.scm multi-parser/id/srfi-12.scm multi-parser/id/mime.scm multi-parser/id/http.scm multi-parser/id/access-remote.scm multi-parser/id/id.scm sxml-tools/xlink-parser.scm multi-parser/ssax-prim.scm multi-parser/multi-parser.scm html-prag/htmlprag.scm sxml-tools/sxml-tools.scm sxml-tools/sxpath-ext.scm sxml-tools/xpath-parser.scm sxml-tools/txpath.scm sxml-tools/sxpath.scm sxml-tools/xpath-ast.scm sxml-tools/xpath-context.scm sxml-tools/xlink.scm sxml-tools/ddo-axes.scm sxml-tools/ddo-txpath.scm sxml-tools/lazy-xpath.scm ssax/lazy-ssax.scm sxml-tools/modif.scm sxml-tools/serializer.scm sxml-tools/guides.scm stx/libmisc.scm stx/stx-engine.scm
	gsc -c libs/gambit/common.scm libs/gambit/myenv.scm libs/srfi-13-local.scm libs/util.scm libs/gambit/parse-error.scm libs/input-parse.scm libs/look-for-str.scm ssax/char-encoding.scm ssax/SSAX-code.scm ssax/SXML-tree-trans.scm sxml-tools/sxpathlib.scm multi-parser/id/srfi-12.scm multi-parser/id/mime.scm multi-parser/id/http.scm multi-parser/id/access-remote.scm multi-parser/id/id.scm sxml-tools/xlink-parser.scm multi-parser/ssax-prim.scm multi-parser/multi-parser.scm html-prag/htmlprag.scm sxml-tools/sxml-tools.scm sxml-tools/sxpath-ext.scm sxml-tools/xpath-parser.scm sxml-tools/txpath.scm sxml-tools/sxpath.scm sxml-tools/xpath-ast.scm sxml-tools/xpath-context.scm sxml-tools/xlink.scm sxml-tools/ddo-axes.scm sxml-tools/ddo-txpath.scm sxml-tools/lazy-xpath.scm ssax/lazy-ssax.scm sxml-tools/modif.scm sxml-tools/serializer.scm sxml-tools/guides.scm stx/libmisc.scm stx/stx-engine.scm
	gsc -flat -link -o ssax-sxml.o1.c libs/gambit/common.c libs/gambit/myenv.c libs/srfi-13-local.c libs/util.c libs/gambit/parse-error.c libs/input-parse.c libs/look-for-str.c ssax/char-encoding.c ssax/SSAX-code.c ssax/SXML-tree-trans.c sxml-tools/sxpathlib.c multi-parser/id/srfi-12.c multi-parser/id/mime.c multi-parser/id/http.c multi-parser/id/access-remote.c multi-parser/id/id.c sxml-tools/xlink-parser.c multi-parser/ssax-prim.c multi-parser/multi-parser.c html-prag/htmlprag.c sxml-tools/sxml-tools.c sxml-tools/sxpath-ext.c sxml-tools/xpath-parser.c sxml-tools/txpath.c sxml-tools/sxpath.c sxml-tools/xpath-ast.c sxml-tools/xpath-context.c sxml-tools/xlink.c sxml-tools/ddo-axes.c sxml-tools/ddo-txpath.c sxml-tools/lazy-xpath.c ssax/lazy-ssax.c sxml-tools/modif.c sxml-tools/serializer.c sxml-tools/guides.c stx/libmisc.c stx/stx-engine.c

example.o1: ssax-sxml.o1 example.c example_.c
	gcc $(INCLUDES) -shared -D___DYNAMIC example.c example_.c ssax-sxml.o1 -lgambc -lm -lutil -ldl -o example.o1

example_.c example.c: ssax-sxml.o1 example.sch example.scm
	gsc -link -flat example.scm

test-sxml.out: ssax-sxml.o1 sxml-tools/tests/xtest-lib.c sxml-tools/tests/xtest-harness.c sxml-tools/tests/xtest-maker.c sxml-tools/tests/vsxpathlib.c sxml-tools/tests/vsxpath-ext.c sxml-tools/tests/vtxpath.c sxml-tools/tests/vcontext.c sxml-tools/tests/vddo.c sxml-tools/tests/vmodif.c test-sxml.c test-sxml_.c
	gcc $(INCLUDES) sxml-tools/tests/xtest-lib.c sxml-tools/tests/xtest-harness.c sxml-tools/tests/xtest-maker.c sxml-tools/tests/vsxpathlib.c sxml-tools/tests/vsxpath-ext.c sxml-tools/tests/vtxpath.c sxml-tools/tests/vcontext.c sxml-tools/tests/vddo.c sxml-tools/tests/vmodif.c test-sxml.c test-sxml_.c ssax-sxml.o1 -lgambc -lm -lutil -ldl -o test-sxml.out

test-sxml_.c sxml-tools/tests/xtest-lib.c sxml-tools/tests/xtest-harness.c sxml-tools/tests/xtest-maker.c sxml-tools/tests/vsxpathlib.c sxml-tools/tests/vsxpath-ext.c sxml-tools/tests/vtxpath.c sxml-tools/tests/vcontext.c sxml-tools/tests/vddo.c sxml-tools/tests/vmodif.c test-sxml.c: ssax-sxml.o1 sxml-tools/tests/xtest-maker.sch sxml-tools/tests/vsxpathlib.sch sxml-tools/tests/vcontext.sch sxml-tools/tests/xtest-harness.sch sxml-tools/tests/xtest-lib.scm sxml-tools/tests/xtest-harness.scm sxml-tools/tests/xtest-maker.scm sxml-tools/tests/vsxpathlib.scm sxml-tools/tests/vsxpath-ext.scm sxml-tools/tests/vtxpath.scm sxml-tools/tests/vcontext.scm sxml-tools/tests/vddo.scm sxml-tools/tests/vmodif.scm test-sxml.scm
	gsc -l ssax-sxml sxml-tools/tests/xtest-lib.scm sxml-tools/tests/xtest-harness.scm sxml-tools/tests/xtest-maker.scm sxml-tools/tests/vsxpathlib.scm sxml-tools/tests/vsxpath-ext.scm sxml-tools/tests/vtxpath.scm sxml-tools/tests/vcontext.scm sxml-tools/tests/vddo.scm sxml-tools/tests/vmodif.scm test-sxml.scm
	mv xtest-lib.c sxml-tools/tests/
	mv xtest-harness.c sxml-tools/tests/
	mv xtest-maker.c sxml-tools/tests/
	mv vsxpathlib.c sxml-tools/tests/
	mv vsxpath-ext.c sxml-tools/tests/
	mv vtxpath.c sxml-tools/tests/
	mv vcontext.c sxml-tools/tests/
	mv vddo.c sxml-tools/tests/
	mv vmodif.c sxml-tools/tests/

#------------------------------------------------
# Extra

clean:
	rm -f libs/gambit/*.c
	rm -f libs/*.c
	rm -f multi-parser/id/*.c
	rm -f multi-parser/*.c
	rm -f html-prag/*.c
	rm -f ssax/*.c
	rm -f sxml-tools/*.c
	rm -f stx/*.c
	rm -f sxml-tools/tests/*.c
	rm -f *.c
	rm -f ssax-sxml.o1
	rm -f *.out
